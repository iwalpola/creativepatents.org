!function(a){Drupal.behaviors.autocomplete={attach:function(b){var c=a(b),d=[];c.find("input.autocomplete").once("autocomplete",function(){var b=this.value;d[b]||(d[b]=new Drupal.ACDB(b));var e=c.find("#"+this.id.substr(0,this.id.length-13)).attr("autocomplete","OFF").attr("aria-autocomplete","list");c.find(e[0].form).submit(Drupal.autocompleteSubmit),e.parents(".form-item").attr("role","application").append(a('<span class="element-invisible" aria-live="assertive"></span>').attr("id",e.attr("id")+"-autocomplete-aria-live")),new Drupal.jsAC(e,d[b],c)})}},Drupal.autocompleteSubmit=function(){return 0===a(".form-autocomplete > .dropdown").each(function(){this.owner.hidePopup()}).length},Drupal.jsAC.prototype.highlight=function(b){this.selected&&a(this.selected).removeClass("active"),a(b).addClass("active"),this.selected=b,a(this.ariaLive).html(a(this.selected).html())},Drupal.jsAC.prototype.unhighlight=function(b){a(b).removeClass("active"),this.selected=!1,a(this.ariaLive).empty()},Drupal.jsAC.prototype.populatePopup=function(){var b=a(this.input);this.popup&&a(this.popup).remove(),this.selected=!1,this.popup=a('<div class="dropdown"></div>')[0],this.popup.owner=this,b.parent().after(this.popup),this.db.owner=this,this.db.search(this.input.value)},Drupal.jsAC.prototype.found=function(b){if(!this.input.value.length)return!1;var c=a('<ul class="dropdown-menu"></ul>'),d=this;c.css({display:"block",right:0});for(var e in b)a("<li></li>").html(a('<a href="#"></a>').html(b[e]).click(function(a){a.preventDefault()})).mousedown(function(){d.select(this)}).mouseover(function(){d.highlight(this)}).mouseout(function(){d.unhighlight(this)}).data("autocompleteValue",e).appendTo(c);this.popup&&(c.children().length?(a(this.popup).empty().append(c).show(),a(this.ariaLive).html(Drupal.t("Autocomplete popup"))):(a(this.popup).css({visibility:"hidden"}),this.hidePopup()))},Drupal.jsAC.prototype.setStatus=function(b){var c=a(this.input).parent().find(".glyphicon-refresh, .autocomplete-throbber").first(),d=c.is(".autocomplete-throbber")?"throbbing":"glyphicon-spin";switch(b){case"begin":c.addClass(d),a(this.ariaLive).html(Drupal.t("Searching for matches..."));break;case"cancel":case"error":case"found":c.removeClass(d)}};var b=Drupal.jsAC.prototype;Drupal.jsAC=function(a,b,c){var d=this;this.$context=c,this.input=a[0],this.ariaLive=c.find("#"+this.input.id+"-autocomplete-aria-live"),this.db=b,a.keydown(function(a){return d.onkeydown(this,a)}).keyup(function(a){d.onkeyup(this,a)}).blur(function(){d.hidePopup(),d.db.cancel()})},Drupal.jsAC.prototype=b}(jQuery);