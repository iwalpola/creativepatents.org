!function(a){Drupal.progressBar=function(b,c,d,e){this.id=b,this.method=d||"GET",this.updateCallback=c,this.errorCallback=e,this.element=a('<div class="progress-wrapper" aria-live="polite"></div>'),this.element.html('<div id ="'+b+'" class="progress progress-striped active"><div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"><div class="percentage sr-only"></div></div></div></div><div class="percentage pull-right"></div><div class="message">&nbsp;</div>')},Drupal.progressBar.prototype.setProgress=function(b,c){b>=0&&100>=b&&(a("div.progress-bar",this.element).css("width",b+"%"),a("div.progress-bar",this.element).attr("aria-valuenow",b),a("div.percentage",this.element).html(b+"%")),a("div.message",this.element).html(c),this.updateCallback&&this.updateCallback(b,c,this)},Drupal.progressBar.prototype.startMonitoring=function(a,b){this.delay=b,this.uri=a,this.sendPing()},Drupal.progressBar.prototype.stopMonitoring=function(){clearTimeout(this.timer),this.uri=null},Drupal.progressBar.prototype.sendPing=function(){if(this.timer&&clearTimeout(this.timer),this.uri){var b=this;a.ajax({type:this.method,url:this.uri,data:"",dataType:"json",success:function(a){return 0===a.status?void b.displayError(a.data):(b.setProgress(a.percentage,a.message),void(b.timer=setTimeout(function(){b.sendPing()},b.delay)))},error:function(a){b.displayError(Drupal.ajaxError(a,b.uri))}})}},Drupal.progressBar.prototype.displayError=function(b){var c=a('<div class="alert alert-block alert-error"><a class="close" data-dismiss="alert" href="#">&times;</a><h4>Error message</h4></div>').append(b);a(this.element).before(c).hide(),this.errorCallback&&this.errorCallback(this)}}(jQuery);